# 第18章 单调栈 - 练习题

## 练习题1：下一个更大元素 I ⭐⭐

**题目描述**：
给定两个没有重复元素的数组 `nums1` 和 `nums2`，其中`nums1`是`nums2`的子集。找到`nums1`中每个元素在`nums2`中的下一个比其大的值。

**要求**：
- 如果不存在下一个更大元素，对应位置输出 -1
- 时间复杂度要求 O(n)
- 空间复杂度要求 O(n)

**示例**：
```
输入: nums1 = [4,1,2], nums2 = [1,3,4,2]
输出: [-1,3,-1]
解释:
  对于num1中的4，在nums2中找不到下一个更大元素，输出 -1
  对于num1中的1，nums2中的下一个更大元素是3
  对于num1中的2，nums2中找不到下一个更大元素，输出 -1

输入: nums1 = [2,4], nums2 = [1,2,3,4]
输出: [3,-1]
```

**提示**：
- 1 ≤ nums1.length ≤ nums2.length ≤ 1000
- 0 ≤ nums1[i], nums2[i] ≤ 10^4
- nums1和nums2中所有整数互不相同
- nums1中的所有整数同样出现在nums2中

---

## 练习题2：每日温度 ⭐⭐⭐

**题目描述**：
根据每日气温列表，请重新生成一个列表，对应位置的输出是需要再等待多久温度才会升高超过该日的天数。如果之后都不会升高，请在该位置用 0 来代替。

**要求**：
- 返回一个新数组，表示等待天数
- 时间复杂度 O(n)
- 空间复杂度 O(n)

**示例**：
```
输入: temperatures = [73, 74, 75, 71, 69, 72, 76, 73]
输出: [1, 1, 4, 2, 1, 1, 0, 0]
解释:
  第1天(73℃)后1天(74℃)温度升高
  第2天(74℃)后1天(75℃)温度升高
  第3天(75℃)后4天(76℃)温度升高
  以此类推...
```

**提示**：
- 1 ≤ temperatures.length ≤ 10^5
- 30 ≤ temperatures[i] ≤ 100

---

## 练习题3：柱状图中最大的矩形 ⭐⭐⭐

**题目描述**：
给定 n 个非负整数，用来表示柱状图中各个柱子的高度。每个柱子彼此相邻，且宽度为 1。求在该柱状图中，能够勾勒出来的矩形的最大面积。

**要求**：
- 计算并返回最大矩形面积
- 时间复杂度 O(n)
- 空间复杂度 O(n)

**示例**：
```
输入: [2,1,5,6,2,3]
输出: 10
解释: 高度为5和6的柱子可组成最大矩形，面积为 5×2=10

输入: [2,4]
输出: 4
```

**提示**：
- 1 ≤ heights.length ≤ 10^5
- 0 ≤ heights[i] ≤ 10^4

---

## 练习题4：接雨水 ⭐⭐⭐⭐

**题目描述**：
给定 n 个非负整数表示每个宽度为 1 的柱子的高度图，计算按此排列的柱子，下雨之后能接多少雨水。

**要求**：
- 计算并返回雨水量
- 时间复杂度 O(n)
- 空间复杂度 O(n)

**示例**：
```
输入: [0,1,0,2,1,0,1,3,2,1,2,1]
输出: 6
解释: 上面是由数组 [0,1,0,2,1,0,1,3,2,1,2,1] 表示的高度图，在这种情况下，可以接 6 个单位的雨水

输入: [4,2,0,3,2,5]
输出: 9
```

**提示**：
- n == height.length
- 1 ≤ n ≤ 2 * 10^4
- 0 ≤ height[i] ≤ 10^5

**解题思路提示**：
- 使用单调递减栈
- 当遇到比栈顶元素大的高度时，计算雨水量
- 栈中存储的是柱子的索引

---

## 练习题5：最大矩形 ⭐⭐⭐⭐⭐

**题目描述**：
给定一个仅包含 0 和 1 、大小为 rows x cols 的二维二进制矩阵，找出只包含 1 的最大矩形，并返回其面积。

**要求**：
- 计算并返回最大矩形面积
- 时间复杂度 O(rows×cols)
- 空间复杂度 O(cols)

**示例**：
```
输入: [
  ["1","0","1","0","0"],
  ["1","0","1","1","1"],
  ["1","1","1","1","1"],
  ["1","0","0","1","0"]
]
输出: 6
解释: 最大矩形如上图所示，面积为 6
```

**提示**：
- rows == matrix.length
- cols == matrix[0].length
- 1 ≤ rows, cols ≤ 200
- matrix[i][j] 为 '0' 或 '1'

**解题思路提示**：
- 将问题转化为柱状图中最大矩形问题
- 对每一行计算高度数组
- 调用柱状图最大矩形算法求解

---

## 难度分析

| 题目 | 难度 | 主要考查点 | 核心技巧 |
|------|------|------------|----------|
| 题目1 | ⭐⭐ | 基础单调栈应用 | 单调递减栈+哈希表 |
| 题目2 | ⭐⭐⭐ | 索引差值计算 | 单调栈存储索引 |
| 题目3 | ⭐⭐⭐ | 边界确定 | 单调递增栈+哨兵技巧 |
| 题目4 | ⭐⭐⭐⭐ | 复杂面积计算 | 单调栈+分层计算 |
| 题目5 | ⭐⭐⭐⭐⭐ | 问题转化 | 矩阵转柱状图+单调栈 |

## 学习建议

1. **循序渐进**：从基础的下一个更大元素问题开始，逐步掌握单调栈的使用
2. **理解本质**：掌握单调栈如何帮助我们在O(n)时间内找到元素间的关系
3. **多做对比**：比较同一问题的暴力解法和单调栈解法，体会效率提升
4. **总结模板**：归纳单调栈的通用代码模板，灵活应用于不同场景
5. **画图分析**：通过画图可视化单调栈的工作过程，加深理解
6. **注意边界**：特别注意处理数组首尾的边界情况，可以使用哨兵技巧简化代码
7. **思考优化**：尝试优化空间复杂度，如使用数组模拟栈而非内置数组
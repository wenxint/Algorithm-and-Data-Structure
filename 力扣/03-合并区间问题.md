# åˆå¹¶åŒºé—´é—®é¢˜ ğŸ“Š

## ğŸ¯ é¢˜ç›®æè¿°
ç»™å‡ºä¸€ä¸ªåŒºé—´çš„é›†åˆï¼Œè¯·åˆå¹¶æ‰€æœ‰é‡å çš„åŒºé—´ã€‚

**è¦æ±‚**ï¼š
- ä»¥æ•°ç»„ `intervals` è¡¨ç¤ºè‹¥å¹²ä¸ªåŒºé—´çš„é›†åˆ
- å…¶ä¸­å•ä¸ªåŒºé—´ä¸º `intervals[i] = [starti, endi]`
- è¯·ä½ åˆå¹¶æ‰€æœ‰é‡å çš„åŒºé—´ï¼Œå¹¶è¿”å›ä¸€ä¸ªä¸é‡å çš„åŒºé—´æ•°ç»„

**ç¤ºä¾‹**ï¼š
```
è¾“å…¥: intervals = [[1,3],[2,6],[8,10],[15,18]]
è¾“å‡º: [[1,6],[8,10],[15,18]]
è§£é‡Š: åŒºé—´ [1,3] å’Œ [2,6] é‡å , å°†å®ƒä»¬åˆå¹¶ä¸º [1,6]

è¾“å…¥: intervals = [[1,4],[4,5]]
è¾“å‡º: [[1,5]]
è§£é‡Š: åŒºé—´ [1,4] å’Œ [4,5] å¯è¢«è§†ä¸ºé‡å åŒºé—´
```

## ğŸ’¡ æˆ‘çš„åŸå§‹æ–¹æ³•

### æ€è·¯åˆ†æ
æˆ‘æœ€å¼€å§‹çš„æƒ³æ³•æ˜¯ï¼š
1. ä¸éœ€è¦æ’åºï¼Œç›´æ¥é€ä¸ªæ¯”è¾ƒåŒºé—´
2. æ‰¾åˆ°é‡å çš„åŒºé—´å°±åˆå¹¶å®ƒä»¬
3. é‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°æ²¡æœ‰å¯åˆå¹¶çš„åŒºé—´

### ä»£ç å®ç°
```javascript
function merge(intervals) {
    if (intervals.length <= 1) return intervals;

    let result = [];
    let merged = false;

    // ä¸æ–­å°è¯•åˆå¹¶ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šåˆå¹¶
    do {
        merged = false;
        result = [];

        for (let i = 0; i < intervals.length; i++) {
            let current = intervals[i];
            let wasMerged = false;

            for (let j = i + 1; j < intervals.length; j++) {
                let next = intervals[j];

                // æ£€æŸ¥æ˜¯å¦é‡å 
                if (current[1] >= next[0] && current[0] <= next[1]) {
                    // åˆå¹¶åŒºé—´
                    let mergedInterval = [
                        Math.min(current[0], next[0]),
                        Math.max(current[1], next[1])
                    ];

                    result.push(mergedInterval);

                    // æ·»åŠ å‰©ä½™çš„åŒºé—´
                    for (let k = 0; k < intervals.length; k++) {
                        if (k !== i && k !== j) {
                            result.push(intervals[k]);
                        }
                    }

                    merged = true;
                    wasMerged = true;
                    break;
                }
            }

            if (wasMerged) break;
        }

        if (!merged) {
            result = intervals;
        } else {
            intervals = result;
        }

    } while (merged);

    return result;
}

// æµ‹è¯•
console.log(merge([[1,3],[2,6],[8,10],[15,18]]));
// æœŸæœ›: [[1,6],[8,10],[15,18]]
```

### å­˜åœ¨çš„é—®é¢˜
- âŒ ç®—æ³•å¤æ‚åº¦è¿‡é«˜ï¼ˆO(nÂ³) æˆ–æ›´å·®ï¼‰
- âŒ é€»è¾‘è¿‡äºå¤æ‚ï¼Œå®¹æ˜“å‡ºé”™
- âŒ æ²¡æœ‰åˆ©ç”¨æ’åºä¼˜åŒ–
- âŒ ä»£ç å¯è¯»æ€§å·®

## ğŸ”§ æ”¹è¿›ç‰ˆæœ¬

### ä¼˜åŒ–æ€è·¯
1. é¦–å…ˆæŒ‰èµ·å§‹ä½ç½®æ’åº
2. ä½¿ç”¨è´ªå¿ƒç­–ç•¥é€ä¸ªåˆå¹¶
3. ç®€åŒ–åˆå¹¶é€»è¾‘
4. æ·»åŠ è¾¹ç•Œå¤„ç†å’Œæ³¨é‡Š

### æ”¹è¿›ä»£ç 
```javascript
/**
 * åˆå¹¶åŒºé—´ç®—æ³•ï¼ˆæ”¹è¿›ç‰ˆï¼‰
 *
 * æ ¸å¿ƒæ€æƒ³ï¼š
 * 1. å…ˆæŒ‰åŒºé—´èµ·å§‹ä½ç½®æ’åºï¼Œè¿™æ ·é‡å çš„åŒºé—´ä¼šç›¸é‚»
 * 2. éå†æ’åºåçš„åŒºé—´ï¼Œå¦‚æœå½“å‰åŒºé—´ä¸å‰ä¸€ä¸ªé‡å å°±åˆå¹¶
 * 3. å¦åˆ™å°†å‰ä¸€ä¸ªåŒºé—´åŠ å…¥ç»“æœï¼Œå¼€å§‹å¤„ç†æ–°çš„åŒºé—´
 *
 * @param {number[][]} intervals - åŒºé—´æ•°ç»„
 * @returns {number[][]} åˆå¹¶åçš„åŒºé—´æ•°ç»„
 * @time O(n log n) ä¸»è¦æ˜¯æ’åºçš„æ—¶é—´å¤æ‚åº¦
 * @space O(n) ç»“æœæ•°ç»„çš„ç©ºé—´
 */
function mergeImproved(intervals) {
    // è¾¹ç•Œæƒ…å†µå¤„ç†
    if (!intervals || intervals.length <= 1) {
        return intervals || [];
    }

    // è¾“å…¥éªŒè¯
    for (let interval of intervals) {
        if (!Array.isArray(interval) || interval.length !== 2) {
            throw new Error('æ¯ä¸ªåŒºé—´å¿…é¡»æ˜¯åŒ…å«ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„');
        }
        if (interval[0] > interval[1]) {
            throw new Error(`æ— æ•ˆåŒºé—´: [${interval[0]}, ${interval[1]}]ï¼Œå¼€å§‹ä½ç½®ä¸èƒ½å¤§äºç»“æŸä½ç½®`);
        }
    }

    console.log('åŸå§‹åŒºé—´:', intervals);

    // æŒ‰èµ·å§‹ä½ç½®æ’åº
    const sortedIntervals = intervals.slice().sort((a, b) => a[0] - b[0]);
    console.log('æ’åºååŒºé—´:', sortedIntervals);

    const result = [];
    let currentInterval = sortedIntervals[0];

    for (let i = 1; i < sortedIntervals.length; i++) {
        const nextInterval = sortedIntervals[i];

        console.log(`æ¯”è¾ƒåŒºé—´: [${currentInterval[0]}, ${currentInterval[1]}] å’Œ [${nextInterval[0]}, ${nextInterval[1]}]`);

        // æ£€æŸ¥æ˜¯å¦é‡å ï¼šå½“å‰åŒºé—´çš„ç»“æŸä½ç½® >= ä¸‹ä¸€ä¸ªåŒºé—´çš„å¼€å§‹ä½ç½®
        if (currentInterval[1] >= nextInterval[0]) {
            // é‡å ï¼Œåˆå¹¶åŒºé—´
            const mergedEnd = Math.max(currentInterval[1], nextInterval[1]);
            currentInterval = [currentInterval[0], mergedEnd];
            console.log(`  â†’ é‡å ï¼Œåˆå¹¶ä¸º: [${currentInterval[0]}, ${currentInterval[1]}]`);
        } else {
            // ä¸é‡å ï¼Œå°†å½“å‰åŒºé—´æ·»åŠ åˆ°ç»“æœä¸­
            result.push(currentInterval);
            currentInterval = nextInterval;
            console.log(`  â†’ ä¸é‡å ï¼Œä¿å­˜ [${result[result.length - 1][0]}, ${result[result.length - 1][1]}]`);
        }
    }

    // ä¸è¦å¿˜è®°æ·»åŠ æœ€åä¸€ä¸ªåŒºé—´
    result.push(currentInterval);

    console.log('æœ€ç»ˆç»“æœ:', result);
    return result;
}

// å®Œæ•´æµ‹è¯•å‡½æ•°
function testMergeIntervals() {
    const testCases = [
        {
            input: [],
            expected: [],
            description: "ç©ºæ•°ç»„"
        },
        {
            input: [[1, 4]],
            expected: [[1, 4]],
            description: "å•ä¸ªåŒºé—´"
        },
        {
            input: [[1,3],[2,6],[8,10],[15,18]],
            expected: [[1,6],[8,10],[15,18]],
            description: "æ ‡å‡†æƒ…å†µ"
        },
        {
            input: [[1,4],[4,5]],
            expected: [[1,5]],
            description: "è¾¹ç•Œé‡å "
        },
        {
            input: [[1,4],[2,3]],
            expected: [[1,4]],
            description: "åŒ…å«å…³ç³»"
        },
        {
            input: [[2,3],[4,5],[6,7],[8,9],[1,10]],
            expected: [[1,10]],
            description: "å®Œå…¨åŒ…å«"
        }
    ];

    testCases.forEach((testCase, index) => {
        console.log(`\n=== æµ‹è¯•ç”¨ä¾‹ ${index + 1}: ${testCase.description} ===`);
        const result = mergeImproved(testCase.input);
        const passed = JSON.stringify(result) === JSON.stringify(testCase.expected);
        console.log(`æœŸæœ›: ${JSON.stringify(testCase.expected)}`);
        console.log(`å®é™…: ${JSON.stringify(result)}`);
        console.log(`ç»“æœ: ${passed ? 'âœ…é€šè¿‡' : 'âŒå¤±è´¥'}`);
    });
}

testMergeIntervals();
```

### æ”¹è¿›äº®ç‚¹
- âœ… æ—¶é—´å¤æ‚åº¦ä» O(nÂ³) é™åˆ° O(n log n)
- âœ… é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºç†è§£
- âœ… æ·»åŠ äº†å®Œæ•´çš„è¾“å…¥éªŒè¯
- âœ… åŒ…å«è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯

## ğŸŒŸ æ¨èçš„æœ€ä½³æ–¹æ³•

### æ ‡å‡†å®ç°ï¼ˆé¢è¯•æ¨èï¼‰
```javascript
/**
 * åˆå¹¶åŒºé—´ - æ ‡å‡†ç®€æ´ç‰ˆæœ¬
 *
 * è¿™æ˜¯æœ€å®¹æ˜“ç†è§£å’Œè®°å¿†çš„ç‰ˆæœ¬ï¼Œé€‚åˆé¢è¯•ä½¿ç”¨
 *
 * @param {number[][]} intervals - åŒºé—´æ•°ç»„
 * @returns {number[][]} åˆå¹¶åçš„åŒºé—´æ•°ç»„
 */
function merge(intervals) {
    if (intervals.length <= 1) return intervals;

    // æŒ‰èµ·å§‹ä½ç½®æ’åº
    intervals.sort((a, b) => a[0] - b[0]);

    const result = [intervals[0]];

    for (let i = 1; i < intervals.length; i++) {
        const current = intervals[i];
        const lastMerged = result[result.length - 1];

        if (current[0] <= lastMerged[1]) {
            // é‡å ï¼Œåˆå¹¶
            lastMerged[1] = Math.max(lastMerged[1], current[1]);
        } else {
            // ä¸é‡å ï¼Œæ·»åŠ æ–°åŒºé—´
            result.push(current);
        }
    }

    return result;
}
```

### å‡½æ•°å¼ç¼–ç¨‹ç‰ˆæœ¬
```javascript
/**
 * åˆå¹¶åŒºé—´ - å‡½æ•°å¼é£æ ¼
 *
 * ä½¿ç”¨ reduce æ–¹æ³•çš„å‡½æ•°å¼ç¼–ç¨‹é£æ ¼
 *
 * @param {number[][]} intervals - åŒºé—´æ•°ç»„
 * @returns {number[][]} åˆå¹¶åçš„åŒºé—´æ•°ç»„
 */
function mergeFunctional(intervals) {
    if (intervals.length <= 1) return intervals;

    return intervals
        .sort((a, b) => a[0] - b[0])
        .reduce((merged, current) => {
            const last = merged[merged.length - 1];

            if (merged.length === 0 || last[1] < current[0]) {
                merged.push(current);
            } else {
                last[1] = Math.max(last[1], current[1]);
            }

            return merged;
        }, []);
}
```

### é€šç”¨åŒºé—´å¤„ç†ç±»
```javascript
/**
 * åŒºé—´å¤„ç†å·¥å…·ç±»
 *
 * æä¾›å„ç§åŒºé—´æ“ä½œçš„é€šç”¨æ–¹æ³•
 */
class IntervalProcessor {
    /**
     * åˆå¹¶é‡å åŒºé—´
     */
    static merge(intervals) {
        if (intervals.length <= 1) return intervals;

        intervals.sort((a, b) => a[0] - b[0]);
        const result = [intervals[0]];

        for (let i = 1; i < intervals.length; i++) {
            const current = intervals[i];
            const last = result[result.length - 1];

            if (current[0] <= last[1]) {
                last[1] = Math.max(last[1], current[1]);
            } else {
                result.push(current);
            }
        }

        return result;
    }

    /**
     * æŸ¥æ‰¾åŒºé—´äº¤é›†
     */
    static intersection(intervals1, intervals2) {
        let i = 0, j = 0;
        const result = [];

        while (i < intervals1.length && j < intervals2.length) {
            const [start1, end1] = intervals1[i];
            const [start2, end2] = intervals2[j];

            // æ‰¾åˆ°é‡å éƒ¨åˆ†
            const start = Math.max(start1, start2);
            const end = Math.min(end1, end2);

            if (start <= end) {
                result.push([start, end]);
            }

            // ç§»åŠ¨æŒ‡é’ˆ
            if (end1 < end2) {
                i++;
            } else {
                j++;
            }
        }

        return result;
    }

    /**
     * æ’å…¥æ–°åŒºé—´å¹¶åˆå¹¶
     */
    static insert(intervals, newInterval) {
        const result = [];
        let i = 0;

        // æ·»åŠ æ‰€æœ‰åœ¨æ–°åŒºé—´ä¹‹å‰çš„åŒºé—´
        while (i < intervals.length && intervals[i][1] < newInterval[0]) {
            result.push(intervals[i]);
            i++;
        }

        // åˆå¹¶é‡å çš„åŒºé—´
        while (i < intervals.length && intervals[i][0] <= newInterval[1]) {
            newInterval[0] = Math.min(newInterval[0], intervals[i][0]);
            newInterval[1] = Math.max(newInterval[1], intervals[i][1]);
            i++;
        }
        result.push(newInterval);

        // æ·»åŠ å‰©ä½™çš„åŒºé—´
        while (i < intervals.length) {
            result.push(intervals[i]);
            i++;
        }

        return result;
    }
}
```

## ğŸ“Š å¤æ‚åº¦åˆ†æ

| ç‰ˆæœ¬ | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------------|------------|------|------|----------|
| æˆ‘çš„åŸå§‹ç‰ˆæœ¬ | O(nÂ³) | O(n) | æ€è·¯ç›´è§‚ | æ•ˆç‡æä½ | ä»…é™å­¦ä¹  |
| æ”¹è¿›ç‰ˆæœ¬ | O(n log n) | O(n) | å¥å£®æ€§å¥½ | ä»£ç è¾ƒé•¿ | ç”Ÿäº§ç¯å¢ƒ |
| æ ‡å‡†ç‰ˆæœ¬ | O(n log n) | O(n) | ç®€æ´é«˜æ•ˆ | åŠŸèƒ½åŸºç¡€ | é¢è¯•æ¨è |
| å‡½æ•°å¼ç‰ˆæœ¬ | O(n log n) | O(n) | ä»£ç ä¼˜é›… | ç†è§£é—¨æ§› | å‡½æ•°å¼é¡¹ç›® |
| å·¥å…·ç±»ç‰ˆæœ¬ | O(n log n) | O(n) | åŠŸèƒ½ä¸°å¯Œ | å¤æ‚åº¦é«˜ | å¤æ‚ä¸šåŠ¡ |

## ğŸ“ çŸ¥è¯†ç‚¹æ€»ç»“

### æ ¸å¿ƒæ¦‚å¿µ
1. **æ’åºä¼˜åŒ–**ï¼šæ’åºåé‡å åŒºé—´ä¼šç›¸é‚»ï¼Œç®€åŒ–åˆå¹¶é€»è¾‘
2. **è´ªå¿ƒç­–ç•¥**ï¼šå±€éƒ¨æœ€ä¼˜é€‰æ‹©ï¼ˆåˆå¹¶å½“å‰é‡å åŒºé—´ï¼‰
3. **åŒºé—´é‡å åˆ¤æ–­**ï¼š`a.end >= b.start`
4. **è¾¹ç•Œå¤„ç†**ï¼šç©ºæ•°ç»„ã€å•åŒºé—´ã€è¾¹ç•Œç›¸ç­‰ç­‰æƒ…å†µ

### å…³é”®æŠ€å·§
- **æ’åºç­–ç•¥**ï¼šæŒ‰èµ·å§‹ä½ç½®æ’åºæ˜¯å…³é”®
- **åˆå¹¶æ¡ä»¶**ï¼š`<=` è¿˜æ˜¯ `<` çš„é€‰æ‹©å¾ˆé‡è¦
- **è´ªå¿ƒæ€æƒ³**ï¼šæ¯æ¬¡éƒ½åˆå¹¶å½“å‰èƒ½åˆå¹¶çš„åŒºé—´
- **çŠ¶æ€ç»´æŠ¤**ï¼šç”¨ä¸€ä¸ªå˜é‡è·Ÿè¸ªå½“å‰æ­£åœ¨æ„å»ºçš„åŒºé—´

### æ‰©å±•åº”ç”¨
1. **æ’å…¥åŒºé—´**ï¼šLeetCode 57
2. **åŒºé—´äº¤é›†**ï¼šLeetCode 986
3. **æ— é‡å åŒºé—´**ï¼šLeetCode 435
4. **æœ€å°‘ç®­æ•°**ï¼šLeetCode 452

## ğŸš¨ å¸¸è§é™·é˜±

### è¾¹ç•Œæ¡ä»¶å¤„ç†
```javascript
// âŒ é”™è¯¯ï¼šå¿˜è®°å¤„ç†è¾¹ç•Œç›¸ç­‰çš„æƒ…å†µ
if (current[0] < lastMerged[1]) {  // åº”è¯¥æ˜¯ <=
    // åˆå¹¶é€»è¾‘
}

// âœ… æ­£ç¡®ï¼šåŒ…å«è¾¹ç•Œç›¸ç­‰
if (current[0] <= lastMerged[1]) {
    // åˆå¹¶é€»è¾‘
}
```

### æ’åºç¨³å®šæ€§
```javascript
// âŒ é”™è¯¯ï¼šå¯èƒ½æ”¹å˜åŸæ•°ç»„
intervals.sort((a, b) => a[0] - b[0]);

// âœ… æ­£ç¡®ï¼šä¸æ”¹å˜åŸæ•°ç»„
const sortedIntervals = intervals.slice().sort((a, b) => a[0] - b[0]);
```

### æœ€ååŒºé—´é—æ¼
```javascript
// âŒ é”™è¯¯ï¼šå®¹æ˜“å¿˜è®°æ·»åŠ æœ€åä¸€ä¸ªåŒºé—´
for (let i = 1; i < intervals.length; i++) {
    // å¤„ç†é€»è¾‘
}
// å¿˜è®°å¤„ç†æœ€åä¸€ä¸ªåŒºé—´

// âœ… æ­£ç¡®ï¼šç¡®ä¿æœ€åä¸€ä¸ªåŒºé—´è¢«å¤„ç†
// åœ¨å¾ªç¯å¤–æ·»åŠ æœ€åä¸€ä¸ªåŒºé—´æˆ–è€…è°ƒæ•´å¾ªç¯é€»è¾‘
```

## ğŸ’­ å­¦ä¹ å¿ƒå¾—

### æˆ‘çš„æ”¶è·
1. **æ’åºçš„é‡è¦æ€§**ï¼šæ­£ç¡®çš„é¢„å¤„ç†èƒ½æå¤§ç®€åŒ–ç®—æ³•
2. **è´ªå¿ƒæ€æƒ³**ï¼šå±€éƒ¨æœ€ä¼˜ç­–ç•¥æœ‰æ—¶èƒ½å¾—åˆ°å…¨å±€æœ€ä¼˜
3. **è¾¹ç•Œæƒ…å†µ**ï¼šåŒºé—´é—®é¢˜çš„è¾¹ç•Œå¤„ç†ç‰¹åˆ«é‡è¦
4. **ç®—æ³•ä¼˜åŒ–**ï¼šä» O(nÂ³) åˆ° O(n log n) çš„å·¨å¤§æå‡

### è§£é¢˜æ¨¡æ¿
```javascript
function solveIntervalProblem(intervals) {
    // 1. è¾¹ç•Œæ£€æŸ¥
    if (intervals.length <= 1) return intervals;

    // 2. æ’åºï¼ˆé€šå¸¸æŒ‰èµ·å§‹ä½ç½®ï¼‰
    intervals.sort((a, b) => a[0] - b[0]);

    // 3. éå†å¤„ç†
    const result = [];
    for (let interval of intervals) {
        // æ ¹æ®å…·ä½“é—®é¢˜å¤„ç†é€»è¾‘
    }

    return result;
}
```

### é¢è¯•æŠ€å·§
- ğŸ¯ **å…ˆæ’åº**ï¼šå‡ ä¹æ‰€æœ‰åŒºé—´é—®é¢˜éƒ½éœ€è¦å…ˆæ’åº
- ğŸ¯ **ç”»å›¾ç†è§£**ï¼šåœ¨çº¸ä¸Šç”»å‡ºåŒºé—´æœ‰åŠ©äºç†è§£
- ğŸ¯ **è€ƒè™‘è¾¹ç•Œ**ï¼šç›¸ç­‰ã€åŒ…å«ã€ç›¸é‚»ç­‰ç‰¹æ®Šæƒ…å†µ
- ğŸ¯ **éªŒè¯é€»è¾‘**ï¼šç”¨ç®€å•ä¾‹å­éªŒè¯åˆå¹¶æ¡ä»¶

### å®é™…åº”ç”¨
- ğŸ“… **æ—¥ç¨‹ç®¡ç†**ï¼šåˆå¹¶é‡å¤çš„æ—¶é—´æ®µ
- ğŸ¬ **è§†é¢‘å‰ªè¾‘**ï¼šåˆå¹¶é‡å çš„ç‰‡æ®µ
- ğŸ“Š **æ•°æ®åˆ†æ**ï¼šåˆå¹¶é‡å çš„æ•°æ®èŒƒå›´
- ğŸŒ **ç½‘ç»œä¼˜åŒ–**ï¼šåˆå¹¶IPåœ°å€æ®µ

---
*å­¦ä¹ æ—¥æœŸï¼š2024å¹´ | éš¾åº¦ï¼šâ­â­â­â˜†â˜†*
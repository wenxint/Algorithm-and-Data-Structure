# å‰ç¼€å’Œç®—æ³•å®ç°é—®é¢˜ ğŸŒŸ

## ğŸ¯ é¢˜ç›®æè¿°
å®ç°ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæ”¯æŒå¯¹æ•°ç»„è¿›è¡Œé«˜æ•ˆçš„åŒºé—´å’ŒæŸ¥è¯¢ã€‚ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œéœ€è¦å¤šæ¬¡æŸ¥è¯¢ä»»æ„åŒºé—´ [left, right] çš„å…ƒç´ å’Œã€‚

**è¦æ±‚**ï¼š
- å®ç° NumArray ç±»æ¥å¤„ç†æ•°ç»„çš„åŒºé—´å’ŒæŸ¥è¯¢
- æ„é€ å‡½æ•° NumArray(nums) ç”¨æ•°ç»„ nums åˆå§‹åŒ–å¯¹è±¡
- æ–¹æ³• sumRange(left, right) è¿”å›æ•°ç»„ä¸­ç´¢å¼• left åˆ° right çš„å…ƒç´ å’Œï¼ˆåŒ…å« left å’Œ rightï¼‰
- éœ€è¦é«˜æ•ˆå¤„ç†å¤šæ¬¡æŸ¥è¯¢æ“ä½œ

**ç¤ºä¾‹**ï¼š
```javascript
// ç¤ºä¾‹ 1
è¾“å…¥: nums = [2, 1, 3, 5, 6, 4]
NumArray numArray = new NumArray(nums);
numArray.sumRange(0, 2);  // è¾“å‡º: 6 (2+1+3)
numArray.sumRange(1, 3);  // è¾“å‡º: 9 (1+3+5)
numArray.sumRange(2, 5);  // è¾“å‡º: 18 (3+5+6+4)

// ç¤ºä¾‹ 2
è¾“å…¥: nums = [-2, 0, 3, -5, 2, -1]
numArray.sumRange(0, 2);  // è¾“å‡º: 1 (-2+0+3)
numArray.sumRange(2, 5);  // è¾“å‡º: -1 (3-5+2-1)

// ç¤ºä¾‹ 3
è¾“å…¥: nums = [1]
numArray.sumRange(0, 0);  // è¾“å‡º: 1

// ç¤ºä¾‹ 4
è¾“å…¥: nums = [5, -3, 5]
numArray.sumRange(1, 2);  // è¾“å‡º: 2 (-3+5)
```

## ğŸ’¡ æˆ‘çš„åŸå§‹æ–¹æ³•

### æ€è·¯åˆ†æ
ç”¨æˆ·çš„åŸå§‹æƒ³æ³•æ˜¯ï¼š
1. ä½¿ç”¨å‰ç¼€å’Œçš„æ ¸å¿ƒæ€æƒ³æ¥ä¼˜åŒ–åŒºé—´å’ŒæŸ¥è¯¢
2. åˆ›å»ºä¸€ä¸ªæ¯”åŸæ•°ç»„é•¿åº¦å¤š1çš„å‰ç¼€å’Œæ•°ç»„ï¼Œindex 0ä½œä¸ºå“¨å…µä½ç½®
3. é€šè¿‡å¾ªç¯è®¡ç®—æ¯ä¸ªä½ç½®çš„å‰ç¼€å’Œ
4. ä½¿ç”¨ç»å…¸çš„å‰ç¼€å’Œå…¬å¼ï¼š`arr[right+1] - arr[left]` æ¥è®¡ç®—åŒºé—´å’Œ

### åŸå§‹ä»£ç 
```javascript
var NumArray = function (nums) {
    let length = nums.length;
    let arr = new Array(length+1).fill(0);
    for (let i = 1; i <= nums.length; i++) {
      arr[i] = arr[i - 1] + nums[i - 1];
    }
    this.arr = arr;
    return this;
};

NumArray.prototype.sumRange = function (left, right) {
    return this.arr[right+1] - this.arr[left];
};
```

### ç®—æ³•ä¼˜ç‚¹
- âœ… **æ ¸å¿ƒæ€æƒ³æ­£ç¡®**ï¼šå®Œå…¨æŒæ¡äº†å‰ç¼€å’Œçš„æ ¸å¿ƒæ€æƒ³ï¼Œä½¿ç”¨é¢„è®¡ç®—æ¥ä¼˜åŒ–æŸ¥è¯¢
- âœ… **ç´¢å¼•è®¾è®¡å·§å¦™**ï¼šä½¿ç”¨`length+1`çš„æ•°ç»„å¤§å°ï¼Œindex 0ä½œä¸ºå“¨å…µé¿å…è¾¹ç•Œé—®é¢˜
- âœ… **æ—¶é—´å¤æ‚åº¦ä¼˜ç§€**ï¼šæ„é€ O(n)ï¼ŒæŸ¥è¯¢O(1)ï¼Œè¾¾åˆ°äº†æœ€ä¼˜å¤æ‚åº¦
- âœ… **å…¬å¼è¿ç”¨æ­£ç¡®**ï¼šå‡†ç¡®ä½¿ç”¨`arr[right+1] - arr[left]`çš„ç»å…¸å‰ç¼€å’Œå…¬å¼

### å­˜åœ¨çš„é—®é¢˜
- âŒ **ä¸å¿…è¦çš„returnè¯­å¥**ï¼šæ„é€ å‡½æ•°ä¸­çš„`return this`æ˜¯å¤šä½™çš„
- âŒ **å˜é‡å‘½åä¸å¤Ÿè¯­ä¹‰åŒ–**ï¼š`arr`è¿™ä¸ªåå­—ä¸å¤Ÿç›´è§‚ï¼Œåº”è¯¥ç”¨`prefixSum`
- âŒ **ç¼ºå°‘è¾¹ç•Œæ£€æŸ¥**ï¼šæ²¡æœ‰å¯¹è¾“å…¥å‚æ•°è¿›è¡ŒéªŒè¯
- âŒ **ç¼ºå°‘æ³¨é‡Š**ï¼šæ²¡æœ‰è¯¦ç»†çš„JSDocæ³¨é‡Šè¯´æ˜ç®—æ³•æ€æƒ³
- âŒ **æ²¡æœ‰é”™è¯¯å¤„ç†**ï¼šå¯¹äºéæ³•è¾“å…¥æ²¡æœ‰å¤„ç†æœºåˆ¶

## ğŸ”§ æ”¹è¿›ç‰ˆæœ¬

### ä¼˜åŒ–æ€è·¯
1. ç§»é™¤æ„é€ å‡½æ•°ä¸­ä¸å¿…è¦çš„returnè¯­å¥
2. ä½¿ç”¨æ›´è¯­ä¹‰åŒ–çš„å˜é‡å`prefixSum`æ›¿ä»£`arr`
3. æ·»åŠ è¯¦ç»†çš„JSDocæ³¨é‡Šè¯´æ˜ç®—æ³•æ ¸å¿ƒæ€æƒ³
4. å¢åŠ è¾¹ç•Œæ¡ä»¶æ£€æŸ¥å’Œé”™è¯¯å¤„ç†
5. æ·»åŠ è°ƒè¯•å’Œç»Ÿè®¡ä¿¡æ¯å¸®åŠ©ç†è§£ç®—æ³•è¿‡ç¨‹

### æ”¹è¿›ä»£ç 
```javascript
/**
 * åŒºé—´å’ŒæŸ¥è¯¢æ•°æ®ç»“æ„ï¼ˆæ”¹è¿›ç‰ˆï¼‰
 *
 * æ ¸å¿ƒæ€æƒ³ï¼š
 * é€šè¿‡é¢„è®¡ç®—å‰ç¼€å’Œæ•°ç»„ï¼Œå°†åŒºé—´å’ŒæŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦ä»O(n)ä¼˜åŒ–åˆ°O(1)
 * å‰ç¼€å’Œå…¬å¼ï¼šprefixSum[i] = nums[0] + nums[1] + ... + nums[i-1]
 * åŒºé—´å’Œå…¬å¼ï¼šsumRange(left, right) = prefixSum[right+1] - prefixSum[left]
 *
 * @param {number[]} nums - åŸå§‹æ•°ç»„
 * @time æ„é€ : O(n), æŸ¥è¯¢: O(1)
 * @space O(n) - å­˜å‚¨å‰ç¼€å’Œæ•°ç»„
 */
var NumArray = function(nums) {
    // è¾¹ç•Œæ¡ä»¶å¤„ç†
    if (!nums || nums.length === 0) {
        this.prefixSum = [0];
        this.originalLength = 0;
        return;
    }

    console.log(`æ„å»ºå‰ç¼€å’Œæ•°ç»„ï¼ŒåŸæ•°ç»„: [${nums.join(', ')}]`);
    console.log(`åŸæ•°ç»„é•¿åº¦: ${nums.length}`);

    const n = nums.length;
    this.originalLength = n;

    // åˆ›å»ºå‰ç¼€å’Œæ•°ç»„ï¼Œå¤§å°ä¸ºn+1ï¼Œindex 0ä½œä¸ºå“¨å…µ
    this.prefixSum = new Array(n + 1).fill(0);

    // è®¡ç®—å‰ç¼€å’Œï¼šprefixSum[i] = nums[0] + nums[1] + ... + nums[i-1]
    for (let i = 1; i <= n; i++) {
        this.prefixSum[i] = this.prefixSum[i - 1] + nums[i - 1];
        console.log(`prefixSum[${i}] = prefixSum[${i-1}] + nums[${i-1}] = ${this.prefixSum[i-1]} + ${nums[i-1]} = ${this.prefixSum[i]}`);
    }

    console.log(`ğŸ“Š å‰ç¼€å’Œæ•°ç»„æ„å»ºå®Œæˆ: [${this.prefixSum.join(', ')}]`);
};

/**
 * æŸ¥è¯¢åŒºé—´å’Œï¼ˆæ”¹è¿›ç‰ˆï¼‰
 *
 * @param {number} left - å·¦è¾¹ç•Œï¼ˆåŒ…å«ï¼‰
 * @param {number} right - å³è¾¹ç•Œï¼ˆåŒ…å«ï¼‰
 * @returns {number} åŒºé—´[left, right]çš„å…ƒç´ å’Œ
 * @time O(1)
 */
NumArray.prototype.sumRange = function(left, right) {
    // è¾¹ç•Œæ£€æŸ¥
    if (left < 0 || right >= this.originalLength || left > right) {
        throw new Error(`æ— æ•ˆçš„åŒºé—´å‚æ•°: [${left}, ${right}]. æœ‰æ•ˆèŒƒå›´: [0, ${this.originalLength - 1}]`);
    }

    // åŒºé—´å’Œ = å³è¾¹ç•Œå‰ç¼€å’Œ - å·¦è¾¹ç•Œå‰ç¼€å’Œ
    const result = this.prefixSum[right + 1] - this.prefixSum[left];

    console.log(`sumRange(${left}, ${right})`);
    console.log(`  = prefixSum[${right + 1}] - prefixSum[${left}]`);
    console.log(`  = ${this.prefixSum[right + 1]} - ${this.prefixSum[left]}`);
    console.log(`  = ${result}`);

    return result;
};

// å®Œæ•´æµ‹è¯•å‡½æ•°
function testNumArrayImproved() {
    const testCases = [
        {
            input: [2, 1, 3, 5, 6, 4],
            queries: [[0, 2], [1, 3], [2, 5], [0, 5]],
            description: "æ ‡å‡†æµ‹è¯•ç”¨ä¾‹"
        },
        {
            input: [-2, 0, 3, -5, 2, -1],
            queries: [[0, 2], [2, 5], [1, 4]],
            description: "åŒ…å«è´Ÿæ•°çš„æµ‹è¯•"
        },
        {
            input: [1],
            queries: [[0, 0]],
            description: "å•å…ƒç´ æ•°ç»„"
        },
        {
            input: [5, -3, 5],
            queries: [[1, 2], [0, 2]],
            description: "å°è§„æ¨¡æµ‹è¯•"
        }
    ];

    testCases.forEach((testCase, index) => {
        console.log(`\n=== æµ‹è¯•ç”¨ä¾‹ ${index + 1}: ${testCase.description} ===`);

        const startTime = performance.now();
        const numArray = new NumArray(testCase.input);
        const constructTime = performance.now();

        console.log(`æ„é€ è€—æ—¶: ${(constructTime - startTime).toFixed(3)}ms`);

        testCase.queries.forEach(([left, right]) => {
            const queryStart = performance.now();
            const result = numArray.sumRange(left, right);
            const queryEnd = performance.now();

            // éªŒè¯ç»“æœæ­£ç¡®æ€§
            const expected = testCase.input.slice(left, right + 1).reduce((sum, num) => sum + num, 0);
            const isCorrect = result === expected;

            console.log(`æŸ¥è¯¢ [${left}, ${right}]: ${result}, æœŸæœ›: ${expected} ${isCorrect ? 'âœ…' : 'âŒ'}`);
            console.log(`æŸ¥è¯¢è€—æ—¶: ${(queryEnd - queryStart).toFixed(3)}ms`);
        });
    });
}

// testNumArrayImproved();
```

### æ”¹è¿›äº®ç‚¹
- âœ… **ä»£ç è§„èŒƒæ€§æå‡**ï¼šç§»é™¤å¤šä½™returnè¯­å¥ï¼Œä½¿ç”¨è¯­ä¹‰åŒ–å‘½å
- âœ… **è¾¹ç•Œå¤„ç†å®Œå–„**ï¼šå¢åŠ è¾“å…¥éªŒè¯å’Œé”™è¯¯å¤„ç†
- âœ… **æ³¨é‡Šè¯¦ç»†ä¸°å¯Œ**ï¼šæ·»åŠ å®Œæ•´çš„JSDocæ³¨é‡Šå’Œç®—æ³•æ€æƒ³è¯´æ˜
- âœ… **è°ƒè¯•ä¿¡æ¯ä¸°å¯Œ**ï¼šæ·»åŠ æ„å»ºå’ŒæŸ¥è¯¢è¿‡ç¨‹çš„è¯¦ç»†æ—¥å¿—
- âœ… **æµ‹è¯•ç”¨ä¾‹å®Œæ•´**ï¼šæä¾›å¤šç§åœºæ™¯çš„æµ‹è¯•éªŒè¯

## ğŸŒŸ æ¨èçš„æœ€ä½³æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šæ ‡å‡†å‰ç¼€å’Œå®ç°ï¼ˆé¢è¯•æ¨èï¼‰
```javascript
/**
 * å‰ç¼€å’Œç®—æ³• - æ ‡å‡†å®ç°
 *
 * æ ¸å¿ƒæ€æƒ³ï¼šé¢„è®¡ç®—å‰ç¼€å’Œï¼Œå®ç°O(1)åŒºé—´æŸ¥è¯¢
 *
 * @param {number[]} nums - è¾“å…¥æ•°ç»„
 * @time æ„é€ : O(n), æŸ¥è¯¢: O(1)
 * @space O(n) ç©ºé—´å¤æ‚åº¦
 */
class NumArray {
    constructor(nums) {
        // æ„å»ºå‰ç¼€å’Œæ•°ç»„ï¼ŒprefixSum[i] = sum(nums[0...i-1])
        this.prefixSum = new Array(nums.length + 1).fill(0);

        for (let i = 0; i < nums.length; i++) {
            this.prefixSum[i + 1] = this.prefixSum[i] + nums[i];
        }
    }

    /**
     * æŸ¥è¯¢åŒºé—´å’Œ
     * @param {number} left - å·¦è¾¹ç•Œ
     * @param {number} right - å³è¾¹ç•Œ
     * @returns {number} åŒºé—´å’Œ
     */
    sumRange(left, right) {
        return this.prefixSum[right + 1] - this.prefixSum[left];
    }
}
```

### æ–¹æ³•äºŒï¼šå‡½æ•°å¼ç¼–ç¨‹é£æ ¼
```javascript
/**
 * å‰ç¼€å’Œç®—æ³• - å‡½æ•°å¼é£æ ¼
 *
 * æ ¸å¿ƒæ€æƒ³ï¼šä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹èŒƒå¼å®ç°å‰ç¼€å’Œ
 */
const createNumArray = (nums) => {
    // ä½¿ç”¨reduceè®¡ç®—å‰ç¼€å’Œ
    const prefixSum = nums.reduce((acc, num, index) => {
        acc.push((acc[index] || 0) + num);
        return acc;
    }, [0]);

    return {
        sumRange: (left, right) => prefixSum[right + 1] - prefixSum[left],
        getPrefixSum: () => [...prefixSum]
    };
};

// ä½¿ç”¨ç¤ºä¾‹
const numArray = createNumArray([2, 1, 3, 5, 6, 4]);
console.log(numArray.sumRange(1, 3)); // 9
```

### æ–¹æ³•ä¸‰ï¼šå¸¦ç¼“å­˜ä¼˜åŒ–çš„ç‰ˆæœ¬
```javascript
/**
 * å‰ç¼€å’Œç®—æ³• - å¸¦æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–
 *
 * æ ¸å¿ƒæ€æƒ³ï¼šå¯¹é¢‘ç¹æŸ¥è¯¢çš„åŒºé—´è¿›è¡Œç¼“å­˜
 */
class OptimizedNumArray {
    constructor(nums) {
        this.prefixSum = new Array(nums.length + 1).fill(0);
        this.queryCache = new Map(); // æŸ¥è¯¢ç»“æœç¼“å­˜
        this.cacheHits = 0;
        this.totalQueries = 0;

        for (let i = 0; i < nums.length; i++) {
            this.prefixSum[i + 1] = this.prefixSum[i] + nums[i];
        }
    }

    sumRange(left, right) {
        this.totalQueries++;
        const key = `${left}-${right}`;

        // æ£€æŸ¥ç¼“å­˜
        if (this.queryCache.has(key)) {
            this.cacheHits++;
            return this.queryCache.get(key);
        }

        // è®¡ç®—ç»“æœå¹¶ç¼“å­˜
        const result = this.prefixSum[right + 1] - this.prefixSum[left];
        this.queryCache.set(key, result);

        return result;
    }

    getCacheStats() {
        return {
            totalQueries: this.totalQueries,
            cacheHits: this.cacheHits,
            hitRate: this.totalQueries > 0 ? (this.cacheHits / this.totalQueries * 100).toFixed(2) + '%' : '0%'
        };
    }
}
```

### æ–¹æ³•å››ï¼šåŸºäºåŸå§‹æ€è·¯çš„æœ€ç»ˆä¼˜åŒ–
```javascript
/**
 * å‰ç¼€å’Œç®—æ³• - åŸºäºç”¨æˆ·åŸå§‹æ€è·¯çš„æœ€ç»ˆä¼˜åŒ–ç‰ˆæœ¬
 *
 * @param {number[]} nums - è¾“å…¥æ•°ç»„
 * @time æ„é€ : O(n), æŸ¥è¯¢: O(1)
 * @space O(n) ç©ºé—´å¤æ‚åº¦
 */
var NumArray = function(nums) {
    const length = nums.length;

    // ä¿æŒç”¨æˆ·åŸå§‹çš„å˜é‡å‘½åé£æ ¼ï¼Œä½†æ·»åŠ è¯­ä¹‰åŒ–æ³¨é‡Š
    this.prefixSumArray = new Array(length + 1).fill(0); // åŸæ¥çš„arrï¼Œç°åœ¨æ›´æ¸…æ™°

    // ä¿æŒç”¨æˆ·åŸå§‹çš„å¾ªç¯é£æ ¼
    for (let i = 1; i <= nums.length; i++) {
        this.prefixSumArray[i] = this.prefixSumArray[i - 1] + nums[i - 1];
    }
    // ç§»é™¤åŸå§‹ä»£ç ä¸­çš„ return this; - æ„é€ å‡½æ•°ä¸éœ€è¦æ˜¾å¼è¿”å›
};

NumArray.prototype.sumRange = function(left, right) {
    // ä¿æŒç”¨æˆ·åŸå§‹çš„æ ¸å¿ƒç®—æ³•é€»è¾‘
    return this.prefixSumArray[right + 1] - this.prefixSumArray[left];
};
```

## ğŸ“Š å¤æ‚åº¦åˆ†æ

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------------|------------|------|------|----------|
| åŸå§‹æ–¹æ³• | æ„é€ O(n), æŸ¥è¯¢O(1) | O(n) | æ€è·¯æ­£ç¡®ï¼Œå®ç°ç®€æ´ | ç¼ºå°‘æ³¨é‡Šå’Œé”™è¯¯å¤„ç† | å­¦ä¹ ç†è§£ |
| æ”¹è¿›æ–¹æ³• | æ„é€ O(n), æŸ¥è¯¢O(1) | O(n) | ä»£ç è§„èŒƒï¼Œé”™è¯¯å¤„ç†å®Œå–„ | è°ƒè¯•ä¿¡æ¯è¾ƒå¤š | å¼€å‘è°ƒè¯• |
| æ ‡å‡†å®ç° | æ„é€ O(n), æŸ¥è¯¢O(1) | O(n) | ç®€æ´é«˜æ•ˆï¼Œé¢è¯•å‹å¥½ | åŠŸèƒ½ç›¸å¯¹åŸºç¡€ | é¢è¯•é¦–é€‰ |
| å‡½æ•°å¼é£æ ¼ | æ„é€ O(n), æŸ¥è¯¢O(1) | O(n) | ä»£ç ç®€æ´ï¼Œå‡½æ•°å¼é£æ ¼ | å¯è¯»æ€§å¯èƒ½è¾ƒå·® | ç‰¹å®šå›¢é˜Ÿåå¥½ |
| ç¼“å­˜ä¼˜åŒ–ç‰ˆ | æ„é€ O(n), æŸ¥è¯¢O(1) | O(n+m) | é‡å¤æŸ¥è¯¢æ€§èƒ½å¥½ | é¢å¤–å†…å­˜å¼€é”€ | å¤§é‡é‡å¤æŸ¥è¯¢ |
| ä¼˜åŒ–åŸæ€è·¯ | æ„é€ O(n), æŸ¥è¯¢O(1) | O(n) | ä¿æŒåŸé£æ ¼ï¼ŒæŠ€æœ¯ä¼˜åŒ– | å˜åŒ–è¾ƒå° | æ¸è¿›å¼æ”¹è¿› |

## ğŸ“ çŸ¥è¯†ç‚¹æ€»ç»“

### æ ¸å¿ƒæ¦‚å¿µ
1. **å‰ç¼€å’Œå®šä¹‰**ï¼šprefixSum[i] è¡¨ç¤ºä»æ•°ç»„å¼€å§‹åˆ°ä½ç½® i-1 çš„æ‰€æœ‰å…ƒç´ ä¹‹å’Œ
2. **å“¨å…µæŠ€å·§**ï¼šä½¿ç”¨ prefixSum[0] = 0 ä½œä¸ºå“¨å…µï¼Œç»Ÿä¸€å¤„ç†è¾¹ç•Œæƒ…å†µ
3. **åŒºé—´å’Œå…¬å¼**ï¼šsum(left, right) = prefixSum[right+1] - prefixSum[left]
4. **æ—¶ç©ºæƒè¡¡**ï¼šç”¨ O(n) çš„é¢å¤–ç©ºé—´æ¢å– O(1) çš„æŸ¥è¯¢æ—¶é—´

### å…³é”®æŠ€å·§
- **ç´¢å¼•æ˜ å°„**ï¼šåŸæ•°ç»„ç´¢å¼• i å¯¹åº”å‰ç¼€å’Œæ•°ç»„ç´¢å¼• i+1
- **è¾¹ç•Œå¤„ç†**ï¼šé€šè¿‡å“¨å…µä½ç½®é¿å…ç‰¹æ®Šæƒ…å†µåˆ¤æ–­
- **çŠ¶æ€é¢„è®¡ç®—**ï¼šä¸€æ¬¡æ„å»ºï¼Œå¤šæ¬¡æŸ¥è¯¢çš„ç»å…¸æ¨¡å¼
- **æ•°å­¦è½¬æ¢**ï¼šå°†åŒºé—´å’Œé—®é¢˜è½¬åŒ–ä¸ºä¸¤ä¸ªå‰ç¼€å’Œçš„å·®å€¼

### å®é™…åº”ç”¨
1. **æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**ï¼šèŒƒå›´æŸ¥è¯¢çš„é¢„è®¡ç®—ä¼˜åŒ–
2. **å›¾åƒå¤„ç†**ï¼šç§¯åˆ†å›¾åƒç”¨äºå¿«é€ŸåŒºåŸŸè®¡ç®—
3. **ç»Ÿè®¡åˆ†æ**ï¼šæ—¶é—´åºåˆ—æ•°æ®çš„åŒºé—´ç»Ÿè®¡
4. **æ¸¸æˆå¼€å‘**ï¼šåœ°å›¾åŒºåŸŸå±æ€§çš„å¿«é€ŸæŸ¥è¯¢

## ğŸš¨ å¸¸è§é™·é˜±

### ç´¢å¼•è¾¹ç•Œé”™è¯¯
```javascript
// âŒ é”™è¯¯ï¼šå®¹æ˜“åœ¨ç´¢å¼•è½¬æ¢æ—¶å‡ºé”™
function sumRangeWrong(left, right) {
    return this.prefixSum[right] - this.prefixSum[left]; // ç¼ºå°‘+1
}

// âœ… æ­£ç¡®ï¼šæ­£ç¡®çš„ç´¢å¼•æ˜ å°„
function sumRangeCorrect(left, right) {
    return this.prefixSum[right + 1] - this.prefixSum[left];
}
```

### æ•°ç»„é•¿åº¦è®¾ç½®é”™è¯¯
```javascript
// âŒ é”™è¯¯ï¼šæ•°ç»„é•¿åº¦ä¸å¤Ÿ
var NumArray = function(nums) {
    this.prefixSum = new Array(nums.length).fill(0); // ç¼ºå°‘+1
};

// âœ… æ­£ç¡®ï¼šä¸ºå“¨å…µä½ç½®é¢„ç•™ç©ºé—´
var NumArray = function(nums) {
    this.prefixSum = new Array(nums.length + 1).fill(0);
};
```

### è¾¹ç•Œæ¡ä»¶æœªå¤„ç†
```javascript
// âŒ é”™è¯¯ï¼šæ²¡æœ‰å¤„ç†ç©ºæ•°ç»„
var NumArray = function(nums) {
    // ç›´æ¥å¤„ç†ï¼Œå¯èƒ½å‡ºé”™
    this.prefixSum = new Array(nums.length + 1).fill(0);
};

// âœ… æ­£ç¡®ï¼šå¤„ç†è¾¹ç•Œæƒ…å†µ
var NumArray = function(nums) {
    if (!nums || nums.length === 0) {
        this.prefixSum = [0];
        return;
    }
    this.prefixSum = new Array(nums.length + 1).fill(0);
};
```

## ğŸ’­ å­¦ä¹ å¿ƒå¾—

### å¯¹ä½ çš„ç®—æ³•è¯„ä»·
1. **æ ¸å¿ƒæ€æƒ³æŒæ¡** âœ…ï¼šå®Œå…¨ç†è§£å‰ç¼€å’Œçš„æ ¸å¿ƒæ€æƒ³ï¼Œç®—æ³•é€»è¾‘å®Œå…¨æ­£ç¡®
2. **ç´¢å¼•è®¾è®¡å·§å¦™** âœ…ï¼šä½¿ç”¨å“¨å…µä½ç½®çš„è®¾è®¡å¾ˆèªæ˜ï¼Œé¿å…äº†è¾¹ç•Œé—®é¢˜
3. **å®ç°ç®€æ´é«˜æ•ˆ** âœ…ï¼šä»£ç ç®€æ´æ˜äº†ï¼Œæ²¡æœ‰å†—ä½™é€»è¾‘
4. **ç»†èŠ‚éœ€è¦å®Œå–„** ğŸ”„ï¼šä¸»è¦æ˜¯ä»£ç è§„èŒƒå’Œé”™è¯¯å¤„ç†æ–¹é¢éœ€è¦æ”¹è¿›

### ä¼˜åŒ–å»ºè®®
1. **ä»£ç è§„èŒƒæ€§**ï¼šç§»é™¤ä¸å¿…è¦çš„returnè¯­å¥ï¼Œä½¿ç”¨æ›´è¯­ä¹‰åŒ–çš„å˜é‡å
2. **æ³¨é‡Šå®Œå–„æ€§**ï¼šæ·»åŠ è¯¦ç»†çš„JSDocæ³¨é‡Šè¯´æ˜ç®—æ³•æ€æƒ³
3. **é”™è¯¯å¤„ç†**ï¼šå¢åŠ è¾¹ç•Œæ£€æŸ¥å’Œå¼‚å¸¸å¤„ç†æœºåˆ¶
4. **æ‰©å±•æ€§è€ƒè™‘**ï¼šå¯ä»¥è€ƒè™‘æ”¯æŒåŠ¨æ€æ›´æ–°ç­‰é«˜çº§åŠŸèƒ½

### è§£é¢˜æ¨¡æ¿
```javascript
function createPrefixSumArray(nums) {
    // 1. è¾¹ç•Œæ£€æŸ¥
    if (!nums || nums.length === 0) return null;

    // 2. æ„å»ºå‰ç¼€å’Œæ•°ç»„
    const prefixSum = new Array(nums.length + 1).fill(0);
    for (let i = 0; i < nums.length; i++) {
        prefixSum[i + 1] = prefixSum[i] + nums[i];
    }

    // 3. è¿”å›æŸ¥è¯¢å‡½æ•°
    return (left, right) => prefixSum[right + 1] - prefixSum[left];
}
```

### é¢è¯•è¦ç‚¹
- ğŸ¯ **ç®—æ³•åŸç†**ï¼šèƒ½å¤Ÿæ¸…æ™°è§£é‡Šå‰ç¼€å’Œçš„æ ¸å¿ƒæ€æƒ³å’Œå·¥ä½œåŸç†
- ğŸ¯ **å¤æ‚åº¦åˆ†æ**ï¼šå‡†ç¡®åˆ†ææ—¶é—´å¤æ‚åº¦O(n)+O(1)å’Œç©ºé—´å¤æ‚åº¦O(n)
- ğŸ¯ **è¾¹ç•Œå¤„ç†**ï¼šè€ƒè™‘ç©ºæ•°ç»„ã€å•å…ƒç´ æ•°ç»„ç­‰ç‰¹æ®Šæƒ…å†µ
- ğŸ¯ **æ‰©å±•åº”ç”¨**ï¼šäº†è§£äºŒç»´å‰ç¼€å’Œã€å·®åˆ†æ•°ç»„ç­‰ç›¸å…³æ¦‚å¿µ

### å®é™…åº”ç”¨åœºæ™¯
- ğŸ“Š **æ•°æ®åˆ†æ**ï¼šå¿«é€Ÿè®¡ç®—æ—¶é—´åºåˆ—çš„åŒºé—´ç»Ÿè®¡
- ğŸ® **æ¸¸æˆå¼€å‘**ï¼šåœ°å›¾åŒºåŸŸèµ„æºçš„å¿«é€ŸæŸ¥è¯¢
- ğŸ–¼ï¸ **å›¾åƒå¤„ç†**ï¼šç§¯åˆ†å›¾åƒæŠ€æœ¯ï¼Œå¿«é€Ÿè®¡ç®—çŸ©å½¢åŒºåŸŸåƒç´ å’Œ
- ğŸ’¾ **æ•°æ®åº“ä¼˜åŒ–**ï¼šèŒƒå›´æŸ¥è¯¢çš„é¢„è®¡ç®—åŠ é€Ÿ

---
*å­¦ä¹ æ—¥æœŸï¼š2024å¹´ | éš¾åº¦ï¼šâ­â­â­â˜†â˜†*
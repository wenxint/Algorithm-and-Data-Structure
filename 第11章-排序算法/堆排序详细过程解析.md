# å †æ’åºè¯¦ç»†è¿‡ç¨‹è§£æ

## æ ¸å¿ƒæ€æƒ³ ğŸ¯

å †æ’åºæ˜¯ä¸€ç§åŸºäº**å †**è¿™ç§æ•°æ®ç»“æ„çš„æ¯”è¾ƒæ’åºç®—æ³•ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š

1. **åˆ©ç”¨å †çš„ç‰¹æ€§**ï¼šæœ€å¤§å †çš„æ ¹èŠ‚ç‚¹æ€»æ˜¯æœ€å¤§å…ƒç´ 
2. **åˆ†ä¸¤é˜¶æ®µå®Œæˆæ’åº**ï¼š
   - å»ºå †é˜¶æ®µï¼šå°†æ— åºæ•°ç»„æ„é€ æˆæœ€å¤§å †
   - æ’åºé˜¶æ®µï¼šåå¤æå–å †é¡¶æœ€å¤§å…ƒç´ å¹¶é‡æ–°è°ƒæ•´å †

å †æ’åºå·§å¦™åœ°å°†"é€‰æ‹©æœ€å¤§å…ƒç´ "çš„æ“ä½œä¼˜åŒ–åˆ°O(log n)ï¼Œä»è€Œå®ç°æ•´ä½“O(n log n)çš„æ—¶é—´å¤æ‚åº¦ã€‚

## ç®—æ³•æ ¸å¿ƒæ¦‚å¿µ

### å †çš„å®šä¹‰
å †æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®Œå…¨äºŒå‰æ ‘ï¼Œåˆ†ä¸ºï¼š
- **æœ€å¤§å †**ï¼šçˆ¶èŠ‚ç‚¹çš„å€¼æ€»æ˜¯å¤§äºç­‰äºå­èŠ‚ç‚¹çš„å€¼
- **æœ€å°å †**ï¼šçˆ¶èŠ‚ç‚¹çš„å€¼æ€»æ˜¯å°äºç­‰äºå­èŠ‚ç‚¹çš„å€¼

### æ•°ç»„è¡¨ç¤ºå †
å¯¹äºæ•°ç»„ç´¢å¼•ä»0å¼€å§‹çš„å †ï¼š
- çˆ¶èŠ‚ç‚¹ç´¢å¼•ï¼š`(i - 1) / 2`
- å·¦å­èŠ‚ç‚¹ç´¢å¼•ï¼š`2 * i + 1`
- å³å­èŠ‚ç‚¹ç´¢å¼•ï¼š`2 * i + 2`

```
æ•°ç»„: [50, 30, 40, 10, 20, 35, 25]
å †çš„æ ‘å½¢ç»“æ„ï¼š
        50
       /  \
      30   40
     / |   | \
    10 20 35 25
```

## ç®—æ³•æ­¥éª¤è¯¦è§£

### ç¬¬ä¸€é˜¶æ®µï¼šå»ºå †(Heapify)

**ç›®æ ‡**ï¼šå°†æ— åºæ•°ç»„è½¬æ¢ä¸ºæœ€å¤§å †

**ç­–ç•¥**ï¼šä»æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹å¼€å§‹ï¼Œå‘ä¸Šé€ä¸ªè°ƒæ•´æ¯ä¸ªèŠ‚ç‚¹

```javascript
/**
 * å»ºå †è¿‡ç¨‹
 * ä»æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹å¼€å§‹å‘ä¸‹è°ƒæ•´
 */
function buildMaxHeap(arr) {
    const n = arr.length;
    // æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹çš„ç´¢å¼•
    for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {
        heapify(arr, n, i);
    }
}
```

### ç¬¬äºŒé˜¶æ®µï¼šæ’åº

**ç›®æ ‡**ï¼šåå¤æå–å †é¡¶æœ€å¤§å…ƒç´ ï¼Œæ”¾åˆ°å·²æ’åºåŒºåŸŸ

**ç­–ç•¥**ï¼š
1. å°†å †é¡¶å…ƒç´ ä¸æœ«å°¾å…ƒç´ äº¤æ¢
2. ç¼©å°å †çš„èŒƒå›´
3. é‡æ–°è°ƒæ•´å †

```javascript
/**
 * å †æ’åºä¸»å‡½æ•°
 */
function heapSort(arr) {
    const n = arr.length;

    // ç¬¬ä¸€é˜¶æ®µï¼šå»ºå †
    buildMaxHeap(arr);

    // ç¬¬äºŒé˜¶æ®µï¼šæ’åº
    for (let i = n - 1; i > 0; i--) {
        // å°†å †é¡¶æœ€å¤§å…ƒç´ äº¤æ¢åˆ°æœ«å°¾
        [arr[0], arr[i]] = [arr[i], arr[0]];

        // é‡æ–°è°ƒæ•´å †ï¼ˆå †å¤§å°å‡1ï¼‰
        heapify(arr, i, 0);
    }

    return arr;
}
```

## æ ¸å¿ƒå‡½æ•°ï¼šheapifyï¼ˆå‘ä¸‹è°ƒæ•´ï¼‰

**ä½œç”¨**ï¼šç»´æŠ¤å †çš„æ€§è´¨ï¼Œå°†å¯èƒ½è¿åå †æ€§è´¨çš„èŠ‚ç‚¹å‘ä¸‹è°ƒæ•´åˆ°æ­£ç¡®ä½ç½®

```javascript
/**
 * å‘ä¸‹è°ƒæ•´ç»´æŠ¤å †æ€§è´¨
 * @param {Array} arr - æ•°ç»„
 * @param {number} heapSize - å †çš„å¤§å°
 * @param {number} i - è¦è°ƒæ•´çš„èŠ‚ç‚¹ç´¢å¼•
 */
function heapify(arr, heapSize, i) {
    let largest = i;        // å‡è®¾å½“å‰èŠ‚ç‚¹æœ€å¤§
    let left = 2 * i + 1;   // å·¦å­èŠ‚ç‚¹
    let right = 2 * i + 2;  // å³å­èŠ‚ç‚¹

    // ä¸å·¦å­èŠ‚ç‚¹æ¯”è¾ƒ
    if (left < heapSize && arr[left] > arr[largest]) {
        largest = left;
    }

    // ä¸å³å­èŠ‚ç‚¹æ¯”è¾ƒ
    if (right < heapSize && arr[right] > arr[largest]) {
        largest = right;
    }

    // å¦‚æœæœ€å¤§å€¼ä¸æ˜¯å½“å‰èŠ‚ç‚¹ï¼Œåˆ™äº¤æ¢å¹¶é€’å½’è°ƒæ•´
    if (largest !== i) {
        [arr[i], arr[largest]] = [arr[largest], arr[i]];
        heapify(arr, heapSize, largest);
    }
}
```

## è¯¦ç»†æ‰§è¡Œè¿‡ç¨‹ç¤ºä¾‹

ä»¥æ•°ç»„ `[4, 10, 3, 5, 1]` ä¸ºä¾‹æ¼”ç¤ºå®Œæ•´è¿‡ç¨‹ï¼š

### åˆå§‹çŠ¶æ€
```
æ•°ç»„: [4, 10, 3, 5, 1]
æ ‘å½¢ç»“æ„ï¼š
    4
   / \
  10  3
 / \
5   1
```

### ç¬¬ä¸€é˜¶æ®µï¼šå»ºå †

**æ­¥éª¤1ï¼šè°ƒæ•´èŠ‚ç‚¹1ï¼ˆå€¼ä¸º10ï¼‰**
```
è°ƒæ•´å‰ï¼š
    4
   / \
  10  3    â† èŠ‚ç‚¹1çš„å­æ ‘å·²ç»æ˜¯å †
 / \
5   1

è°ƒæ•´åï¼šæ— éœ€è°ƒæ•´ï¼Œå› ä¸º10 > 5 ä¸” 10 > 1
```

**æ­¥éª¤2ï¼šè°ƒæ•´èŠ‚ç‚¹0ï¼ˆå€¼ä¸º4ï¼‰**
```
è°ƒæ•´å‰ï¼š
    4         â† éœ€è¦è°ƒæ•´ï¼Œå› ä¸º4 < 10
   / \
  10  3
 / \
5   1

ç¬¬ä¸€æ¬¡è°ƒæ•´ï¼š4ä¸10äº¤æ¢
   10
   / \
   4  3
  / \
 5   1

ç»§ç»­è°ƒæ•´ï¼š4ä¸5äº¤æ¢
   10
   / \
   5  3
  / \
 4   1

å»ºå †å®Œæˆï¼
```

**å»ºå †ç»“æœ**ï¼š`[10, 5, 3, 4, 1]`

### ç¬¬äºŒé˜¶æ®µï¼šæ’åº

**ç¬¬1è½®ï¼šæå–æœ€å¤§å…ƒç´ 10**
```
äº¤æ¢å †é¡¶å’Œæœ«å°¾ï¼š[1, 5, 3, 4, 10]
                            â†‘ å·²æ’åºåŒº

é‡æ–°è°ƒæ•´å †ï¼ˆå¤§å°=4ï¼‰ï¼š
åŸï¼š  1
     / \
    5   3
   /
  4

è°ƒæ•´åï¼š5
       / \
      4   3
     /
    1

ç»“æœï¼š[5, 4, 3, 1, 10]
```

**ç¬¬2è½®ï¼šæå–æœ€å¤§å…ƒç´ 5**
```
äº¤æ¢ï¼š[1, 4, 3, 5, 10]
              â†‘ å·²æ’åºåŒº

è°ƒæ•´å †ï¼ˆå¤§å°=3ï¼‰ï¼š
åŸï¼š  1
     / \
    4   3

è°ƒæ•´åï¼š4
       / \
      1   3

ç»“æœï¼š[4, 1, 3, 5, 10]
```

**ç¬¬3è½®ï¼šæå–æœ€å¤§å…ƒç´ 4**
```
äº¤æ¢ï¼š[3, 1, 4, 5, 10]
           â†‘ å·²æ’åºåŒº

è°ƒæ•´å †ï¼ˆå¤§å°=2ï¼‰ï¼š
åŸï¼š  3
     /
    1

æ— éœ€è°ƒæ•´ï¼š3 > 1

ç»“æœï¼š[3, 1, 4, 5, 10]
```

**ç¬¬4è½®ï¼šæå–æœ€å¤§å…ƒç´ 3**
```
äº¤æ¢ï¼š[1, 3, 4, 5, 10]
        â†‘ å·²æ’åºåŒº

åªå‰©ä¸€ä¸ªå…ƒç´ ï¼Œæ— éœ€è°ƒæ•´
```

**æœ€ç»ˆç»“æœ**ï¼š`[1, 3, 4, 5, 10]` âœ…

## å¯è§†åŒ–è¿‡ç¨‹æ€»ç»“

```
åˆå§‹æ•°ç»„ï¼š[4, 10, 3, 5, 1]

å»ºå †é˜¶æ®µï¼š
[4, 10, 3, 5, 1] â†’ [10, 5, 3, 4, 1]

æ’åºé˜¶æ®µï¼š
[10, 5, 3, 4, 1] â†’ [5, 4, 3, 1, |10]
[5, 4, 3, 1, |10] â†’ [4, 1, 3, |5, 10]
[4, 1, 3, |5, 10] â†’ [3, 1, |4, 5, 10]
[3, 1, |4, 5, 10] â†’ [1, |3, 4, 5, 10]

æœ€ç»ˆç»“æœï¼š[1, 3, 4, 5, 10]
```

## å¤æ‚åº¦åˆ†æ

### æ—¶é—´å¤æ‚åº¦
- **å»ºå †é˜¶æ®µ**ï¼šO(n)
  - è™½ç„¶æœ‰n/2ä¸ªèŠ‚ç‚¹éœ€è¦è°ƒæ•´ï¼Œä½†å¤§éƒ¨åˆ†èŠ‚ç‚¹çš„è°ƒæ•´æ·±åº¦å¾ˆå°
  - æ•°å­¦è¯æ˜ï¼šâˆ‘(h=0 to log n) [n/2^(h+1)] Ã— h = O(n)

- **æ’åºé˜¶æ®µ**ï¼šO(n log n)
  - éœ€è¦è¿›è¡Œn-1æ¬¡"æå–æœ€å¤§å€¼"æ“ä½œ
  - æ¯æ¬¡è°ƒæ•´å †çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log n)

- **æ€»ä½“æ—¶é—´å¤æ‚åº¦**ï¼šO(n log n)ï¼ˆæ‰€æœ‰æƒ…å†µï¼‰

### ç©ºé—´å¤æ‚åº¦
- **O(1)**ï¼šåŸåœ°æ’åºï¼Œåªéœ€è¦å¸¸æ•°çº§é¢å¤–ç©ºé—´
- é€’å½’è°ƒç”¨æ ˆæ·±åº¦ï¼šO(log n)

### ç¨³å®šæ€§
- **ä¸ç¨³å®š**ï¼šç›¸åŒå…ƒç´ çš„ç›¸å¯¹ä½ç½®å¯èƒ½æ”¹å˜
- ä¾‹å¦‚ï¼š[5a, 5b, 3] å¯èƒ½å˜æˆ [3, 5b, 5a]

## ç®—æ³•ç‰¹ç‚¹æ€»ç»“

### ä¼˜ç‚¹ âœ…
1. **æ—¶é—´å¤æ‚åº¦ç¨³å®š**ï¼šæ— è®ºæœ€å¥½ã€å¹³å‡è¿˜æ˜¯æœ€åæƒ…å†µéƒ½æ˜¯O(n log n)
2. **ç©ºé—´å¤æ‚åº¦ä¼˜ç§€**ï¼šO(1)åŸåœ°æ’åº
3. **ä¸å—è¾“å…¥æ•°æ®åˆ†å¸ƒå½±å“**ï¼šæ€§èƒ½ç¨³å®šå¯é¢„æµ‹

### ç¼ºç‚¹ âŒ
1. **ä¸ç¨³å®š**ï¼šç›¸åŒå…ƒç´ çš„ç›¸å¯¹é¡ºåºå¯èƒ½æ”¹å˜
2. **å¸¸æ•°å› å­è¾ƒå¤§**ï¼šå®é™…è¿è¡Œæ—¶é—´é€šå¸¸æ¯”å¿«é€Ÿæ’åºæ…¢
3. **ç¼“å­˜ä¸å‹å¥½**ï¼šå †çš„è®¿é—®æ¨¡å¼å¯¹CPUç¼“å­˜ä¸å‹å¥½

## é€‚ç”¨åœºæ™¯

### æœ€ä½³ä½¿ç”¨åœºæ™¯ ğŸ¯
1. **å¯¹æ—¶é—´å¤æ‚åº¦è¦æ±‚ä¸¥æ ¼**ï¼šä¸èƒ½æ¥å—å¿«é€Ÿæ’åºçš„O(nÂ²)æœ€åæƒ…å†µ
2. **å†…å­˜ç©ºé—´å—é™**ï¼šéœ€è¦åŸåœ°æ’åº
3. **éœ€è¦Top-Ké—®é¢˜çš„è§£å†³æ–¹æ¡ˆ**ï¼šå †çš„ç‰¹æ€§å¤©ç„¶é€‚åˆ

### å®é™…åº”ç”¨
1. **ä¼˜å…ˆé˜Ÿåˆ—çš„å®ç°**
2. **æ“ä½œç³»ç»Ÿçš„ä»»åŠ¡è°ƒåº¦**
3. **å›¾ç®—æ³•ä¸­çš„æœ€çŸ­è·¯å¾„**ï¼ˆDijkstraç®—æ³•ï¼‰
4. **å¤§æ•°æ®å¤„ç†ä¸­çš„Top-Ké—®é¢˜**

## å®Œæ•´å®ç°

```javascript
/**
 * å †æ’åºå®Œæ•´å®ç°
 * @param {number[]} arr - å¾…æ’åºæ•°ç»„
 * @returns {number[]} - æ’åºåçš„æ•°ç»„
 */
function heapSort(arr) {
    const result = [...arr]; // é¿å…ä¿®æ”¹åŸæ•°ç»„
    const n = result.length;

    // ç¬¬ä¸€é˜¶æ®µï¼šå»ºå †
    // ä»æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹å¼€å§‹å‘ä¸Šè°ƒæ•´
    for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {
        heapify(result, n, i);
    }

    // ç¬¬äºŒé˜¶æ®µï¼šæ’åº
    // åå¤æå–å †é¡¶æœ€å¤§å…ƒç´ 
    for (let i = n - 1; i > 0; i--) {
        // å°†å †é¡¶æœ€å¤§å…ƒç´ äº¤æ¢åˆ°å·²æ’åºåŒºåŸŸ
        [result[0], result[i]] = [result[i], result[0]];

        // é‡æ–°è°ƒæ•´å †ï¼ˆå †å¤§å°å‡1ï¼‰
        heapify(result, i, 0);
    }

    return result;
}

/**
 * å †è°ƒæ•´å‡½æ•°ï¼ˆå‘ä¸‹è°ƒæ•´ï¼‰
 * @param {number[]} arr - æ•°ç»„
 * @param {number} heapSize - å †çš„å¤§å°
 * @param {number} i - è¦è°ƒæ•´çš„èŠ‚ç‚¹ç´¢å¼•
 */
function heapify(arr, heapSize, i) {
    let largest = i;        // å‡è®¾å½“å‰èŠ‚ç‚¹æœ€å¤§
    let left = 2 * i + 1;   // å·¦å­èŠ‚ç‚¹ç´¢å¼•
    let right = 2 * i + 2;  // å³å­èŠ‚ç‚¹ç´¢å¼•

    // æ‰¾åˆ°çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ä¸­çš„æœ€å¤§å€¼
    if (left < heapSize && arr[left] > arr[largest]) {
        largest = left;
    }

    if (right < heapSize && arr[right] > arr[largest]) {
        largest = right;
    }

    // å¦‚æœæœ€å¤§å€¼ä¸æ˜¯å½“å‰èŠ‚ç‚¹ï¼Œåˆ™äº¤æ¢å¹¶ç»§ç»­è°ƒæ•´
    if (largest !== i) {
        [arr[i], arr[largest]] = [arr[largest], arr[i]];
        heapify(arr, heapSize, largest);
    }
}

// æµ‹è¯•ç¤ºä¾‹
const testArray = [4, 10, 3, 5, 1, 6, 8, 2, 7, 9];
console.log("åŸæ•°ç»„ï¼š", testArray);
console.log("æ’åºåï¼š", heapSort(testArray));
// è¾“å‡ºï¼šæ’åºåï¼š[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
```

å †æ’åºæ˜¯ä¸€ä¸ªä¼˜é›…çš„ç®—æ³•ï¼Œå®ƒå°†é€‰æ‹©æ’åºçš„æ€æƒ³ä¸å †æ•°æ®ç»“æ„å®Œç¾ç»“åˆï¼Œåœ¨ä¿è¯O(n log n)æ—¶é—´å¤æ‚åº¦çš„åŒæ—¶å®ç°äº†åŸåœ°æ’åºã€‚è™½ç„¶åœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½ä¸å¦‚å¿«é€Ÿæ’åºå¿«ï¼Œä½†å…¶ç¨³å®šçš„æ€§èƒ½è¡¨ç°ä½¿å…¶åœ¨æŸäº›åœºæ™¯ä¸‹ä»ç„¶æ˜¯ä¼˜ç§€çš„é€‰æ‹©ã€‚
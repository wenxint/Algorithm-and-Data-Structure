<!--
 * @ä½œè€…: kerwin
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é˜Ÿåˆ—ç»“æ„çš„å°è£…</title>
</head>

<body>
    <script>
        /**
         * é˜Ÿåˆ—æ•°æ®ç»“æ„å®ç°
         *
         * æ ¸å¿ƒæ€æƒ³ï¼š
         * é˜Ÿåˆ—æ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡ºï¼ˆFIFO - First In First Outï¼‰çš„çº¿æ€§æ•°æ®ç»“æ„
         * å°±åƒæ’é˜Ÿä¹°ç¥¨ï¼Œå…ˆæ¥çš„äººå…ˆæœåŠ¡ï¼Œåæ¥çš„äººæ’åœ¨é˜Ÿå°¾
         *
         * ä¸»è¦ç‰¹ç‚¹ï¼š
         * 1. åªèƒ½åœ¨é˜Ÿå°¾æ·»åŠ å…ƒç´ ï¼ˆå…¥é˜Ÿï¼‰ï¼Œåœ¨é˜Ÿå¤´åˆ é™¤å…ƒç´ ï¼ˆå‡ºé˜Ÿï¼‰
         * 2. æœ€å…ˆæ’å…¥çš„å…ƒç´ æœ€å…ˆè¢«åˆ é™¤
         * 3. å…¥é˜Ÿå’Œå‡ºé˜Ÿçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)
         *
         * åº”ç”¨åœºæ™¯ï¼š
         * - ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ
         * - å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰
         * - æ‰“å°é˜Ÿåˆ—
         * - ç¼“å†²åŒºç®¡ç†
         * - è¿›ç¨‹è°ƒåº¦
         */
        class Queue {
            /**
             * æ„é€ å‡½æ•° - åˆå§‹åŒ–é˜Ÿåˆ—
             */
            constructor() {
                // ä½¿ç”¨ç§æœ‰å±æ€§å­˜å‚¨é˜Ÿåˆ—å…ƒç´ ï¼Œé˜²æ­¢å¤–éƒ¨ç›´æ¥è®¿é—®
                this.#items = [];
            }

            // ç§æœ‰å±æ€§ï¼šå­˜å‚¨é˜Ÿåˆ—ä¸­çš„å…ƒç´ 
            #items = [];

            /**
             * å‡ºé˜Ÿæ“ä½œ - ç§»é™¤å¹¶è¿”å›é˜Ÿå¤´å…ƒç´ 
             *
             * æ ¸å¿ƒæ€æƒ³ï¼š
             * ç§»é™¤é˜Ÿå¤´ï¼ˆæ•°ç»„å¼€å¤´ï¼‰çš„å…ƒç´ ï¼Œä½“ç°FIFOç‰¹æ€§
             *
             * @returns {*} é˜Ÿå¤´å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºåˆ™è¿”å›undefined
             * @time O(1) - å¸¸æ•°æ—¶é—´å¤æ‚åº¦ï¼ˆåœ¨JavaScriptä¸­shift()å®é™…æ˜¯O(n)ï¼Œä½†æ¦‚å¿µä¸Šæ˜¯O(1)ï¼‰
             * @space O(1) - å¸¸æ•°ç©ºé—´å¤æ‚åº¦
             */
            dequeue() {
                // æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
                if (this.isEmpty()) {
                    console.log('é˜Ÿåˆ—ä¸ºç©ºï¼Œæ— æ³•æ‰§è¡Œå‡ºé˜Ÿæ“ä½œ');
                    return undefined;
                }

                const element = this.#items.shift();
                console.log(`å‡ºé˜Ÿå…ƒç´ : ${element}`);
                return element;
            }

            /**
             * å…¥é˜Ÿæ“ä½œ - å‘é˜Ÿå°¾æ·»åŠ å…ƒç´ 
             *
             * æ ¸å¿ƒæ€æƒ³ï¼š
             * åœ¨é˜Ÿå°¾ï¼ˆæ•°ç»„æœ«å°¾ï¼‰æ·»åŠ æ–°å…ƒç´ 
             *
             * @param {*} data - è¦æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­çš„å…ƒç´ 
             * @time O(1) - å¸¸æ•°æ—¶é—´å¤æ‚åº¦
             * @space O(1) - å¸¸æ•°ç©ºé—´å¤æ‚åº¦
             */
            enqueue(data) {
                this.#items.push(data);
                console.log(`å…¥é˜Ÿå…ƒç´ : ${data}`);
            }

            /**
             * æŸ¥çœ‹é˜Ÿå¤´å…ƒç´  - è¿”å›é˜Ÿå¤´å…ƒç´ ä½†ä¸ç§»é™¤
             *
             * æ ¸å¿ƒæ€æƒ³ï¼š
             * æŸ¥çœ‹é˜Ÿå¤´å…ƒç´ è€Œä¸æ”¹å˜é˜Ÿåˆ—çš„çŠ¶æ€
             *
             * @returns {*} é˜Ÿå¤´å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºåˆ™è¿”å›undefined
             * @time O(1) - å¸¸æ•°æ—¶é—´å¤æ‚åº¦
             * @space O(1) - å¸¸æ•°ç©ºé—´å¤æ‚åº¦
             */
            front() {
                if (this.isEmpty()) {
                    console.log('é˜Ÿåˆ—ä¸ºç©ºï¼Œæ²¡æœ‰é˜Ÿå¤´å…ƒç´ ');
                    return undefined;
                }

                // ä½¿ç”¨at(0)è·å–ç¬¬ä¸€ä¸ªå…ƒç´ 
                const frontElement = this.#items.at(0);
                console.log(`é˜Ÿå¤´å…ƒç´ : ${frontElement}`);
                return frontElement;
            }

            /**
             * åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
             *
             * @returns {boolean} å¦‚æœé˜Ÿåˆ—ä¸ºç©ºè¿”å›trueï¼Œå¦åˆ™è¿”å›false
             * @time O(1) - å¸¸æ•°æ—¶é—´å¤æ‚åº¦
             * @space O(1) - å¸¸æ•°ç©ºé—´å¤æ‚åº¦
             */
            isEmpty() {
                return this.#items.length === 0;
            }

            /**
             * è·å–é˜Ÿåˆ—çš„å¤§å°
             *
             * @returns {number} é˜Ÿåˆ—ä¸­å…ƒç´ çš„ä¸ªæ•°
             * @time O(1) - å¸¸æ•°æ—¶é—´å¤æ‚åº¦
             * @space O(1) - å¸¸æ•°ç©ºé—´å¤æ‚åº¦
             */
            size() {
                return this.#items.length;
            }

            /**
             * æ¸…ç©ºé˜Ÿåˆ—
             *
             * æ ¸å¿ƒæ€æƒ³ï¼š
             * é‡ç½®å†…éƒ¨æ•°ç»„ï¼Œç§»é™¤æ‰€æœ‰å…ƒç´ 
             *
             * @time O(1) - å¸¸æ•°æ—¶é—´å¤æ‚åº¦
             * @space O(1) - å¸¸æ•°ç©ºé—´å¤æ‚åº¦
             */
            clear() {
                this.#items = [];
                console.log('é˜Ÿåˆ—å·²æ¸…ç©º');
            }

            /**
             * å°†é˜Ÿåˆ—è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¡¨ç¤º
             *
             * @returns {string} é˜Ÿåˆ—çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œä»é˜Ÿå¤´åˆ°é˜Ÿå°¾
             * @time O(n) - çº¿æ€§æ—¶é—´å¤æ‚åº¦ï¼Œnä¸ºé˜Ÿåˆ—ä¸­å…ƒç´ ä¸ªæ•°
             * @space O(n) - çº¿æ€§ç©ºé—´å¤æ‚åº¦
             */
            toString() {
                if (this.isEmpty()) {
                    return 'ç©ºé˜Ÿåˆ—';
                }
                return `é˜Ÿåˆ—å†…å®¹ï¼ˆé˜Ÿå¤´->é˜Ÿå°¾ï¼‰: ${this.#items.join(' -> ')}`;
            }

            /**
             * è·å–é˜Ÿåˆ—çš„è¯¦ç»†ä¿¡æ¯
             *
             * @returns {object} åŒ…å«é˜Ÿåˆ—è¯¦ç»†ä¿¡æ¯çš„å¯¹è±¡
             */
            getInfo() {
                return {
                    size: this.size(),
                    isEmpty: this.isEmpty(),
                    front: this.isEmpty() ? null : this.#items[0],
                    rear: this.isEmpty() ? null : this.#items[this.#items.length - 1],
                    content: this.toString()
                };
            }
        }

        // ==================== å®Œæ•´çš„è°ƒç”¨ç¤ºä¾‹ ====================
        console.log('=== é˜Ÿåˆ—ç»“æ„çš„å°è£… - å®Œæ•´ç¤ºä¾‹ ===\n');

        // 1. åˆ›å»ºé˜Ÿåˆ—å®ä¾‹
        console.log('1. åˆ›å»ºé˜Ÿåˆ—å®ä¾‹');
        const queue = new Queue();
        console.log('é˜Ÿåˆ—ä¿¡æ¯:', queue.getInfo());
        console.log();

        // 2. æµ‹è¯•ç©ºé˜Ÿåˆ—æ“ä½œ
        console.log('2. æµ‹è¯•ç©ºé˜Ÿåˆ—æ“ä½œ');
        console.log('å°è¯•ä»ç©ºé˜Ÿåˆ—å‡ºé˜Ÿ:', queue.dequeue());
        console.log('å°è¯•æŸ¥çœ‹ç©ºé˜Ÿåˆ—é˜Ÿå¤´å…ƒç´ :', queue.front());
        console.log();

        // 3. å…¥é˜Ÿæ“ä½œæ¼”ç¤º
        console.log('3. å…¥é˜Ÿæ“ä½œæ¼”ç¤º');
        const customers = ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­', 'å­™ä¸ƒ'];
        customers.forEach(customer => {
            queue.enqueue(customer);
            console.log(`å½“å‰é˜Ÿåˆ—çŠ¶æ€: ${queue.toString()}`);
        });
        console.log();

        // 4. æŸ¥çœ‹é˜Ÿå¤´å…ƒç´ 
        console.log('4. æŸ¥çœ‹é˜Ÿå¤´å…ƒç´ ');
        queue.front();
        console.log(`é˜Ÿåˆ—å¤§å°: ${queue.size()}`);
        console.log();

        // 5. å‡ºé˜Ÿæ“ä½œæ¼”ç¤º
        console.log('5. å‡ºé˜Ÿæ“ä½œæ¼”ç¤º');
        while (!queue.isEmpty()) {
            const customer = queue.dequeue();
            console.log(`${customer} å·²è¢«æœåŠ¡`);
            console.log(`å‰©ä½™é˜Ÿåˆ—çŠ¶æ€: ${queue.toString()}`);
            console.log(`é˜Ÿåˆ—å¤§å°: ${queue.size()}`);
        }
        console.log();

        // 6. å®é™…åº”ç”¨ç¤ºä¾‹ï¼šä»»åŠ¡è°ƒåº¦å™¨
        console.log('6. å®é™…åº”ç”¨ç¤ºä¾‹ï¼šä»»åŠ¡è°ƒåº¦å™¨');

        /**
         * ç®€å•çš„ä»»åŠ¡è°ƒåº¦å™¨
         *
         * æ ¸å¿ƒæ€æƒ³ï¼š
         * ä½¿ç”¨é˜Ÿåˆ—ç®¡ç†å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼ŒæŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œ
         *
         * @class TaskScheduler
         */
        class TaskScheduler {
            constructor() {
                this.taskQueue = new Queue();
                this.isRunning = false;
            }

            /**
             * æ·»åŠ ä»»åŠ¡åˆ°é˜Ÿåˆ—
             * @param {string} taskName - ä»»åŠ¡åç§°
             * @param {Function} taskFunction - ä»»åŠ¡å‡½æ•°
             * @param {number} delay - ä»»åŠ¡æ‰§è¡Œå»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
             */
            addTask(taskName, taskFunction, delay = 1000) {
                const task = {
                    name: taskName,
                    execute: taskFunction,
                    delay: delay,
                    addTime: new Date().toLocaleTimeString()
                };

                this.taskQueue.enqueue(task);
                console.log(`ä»»åŠ¡ "${taskName}" å·²æ·»åŠ åˆ°é˜Ÿåˆ—ï¼Œæ·»åŠ æ—¶é—´: ${task.addTime}`);

                // å¦‚æœè°ƒåº¦å™¨æœªè¿è¡Œï¼Œå¯åŠ¨å®ƒ
                if (!this.isRunning) {
                    this.start();
                }
            }

            /**
             * å¯åŠ¨ä»»åŠ¡è°ƒåº¦å™¨
             */
            async start() {
                if (this.isRunning) {
                    console.log('ä»»åŠ¡è°ƒåº¦å™¨å·²åœ¨è¿è¡Œ');
                    return;
                }

                this.isRunning = true;
                console.log('ä»»åŠ¡è°ƒåº¦å™¨å¯åŠ¨');

                while (!this.taskQueue.isEmpty()) {
                    const task = this.taskQueue.dequeue();
                    console.log(`å¼€å§‹æ‰§è¡Œä»»åŠ¡: ${task.name}`);

                    // æ¨¡æ‹Ÿä»»åŠ¡æ‰§è¡Œ
                    await new Promise(resolve => {
                        setTimeout(() => {
                            task.execute();
                            console.log(`ä»»åŠ¡ "${task.name}" æ‰§è¡Œå®Œæˆ`);
                            resolve();
                        }, task.delay);
                    });
                }

                this.isRunning = false;
                console.log('æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œè°ƒåº¦å™¨åœæ­¢');
            }

            /**
             * è·å–é˜Ÿåˆ—çŠ¶æ€
             */
            getStatus() {
                return {
                    isRunning: this.isRunning,
                    pendingTasks: this.taskQueue.size(),
                    queueContent: this.taskQueue.toString()
                };
            }
        }

        // æµ‹è¯•ä»»åŠ¡è°ƒåº¦å™¨
        const scheduler = new TaskScheduler();

        // æ·»åŠ ä¸€äº›æµ‹è¯•ä»»åŠ¡
        scheduler.addTask('å‘é€é‚®ä»¶', () => console.log('ğŸ“§ é‚®ä»¶å·²å‘é€'), 500);
        scheduler.addTask('å¤‡ä»½æ•°æ®', () => console.log('ğŸ’¾ æ•°æ®å¤‡ä»½å®Œæˆ'), 800);
        scheduler.addTask('æ¸…ç†ç¼“å­˜', () => console.log('ğŸ§¹ ç¼“å­˜æ¸…ç†å®Œæˆ'), 300);
        scheduler.addTask('ç”ŸæˆæŠ¥å‘Š', () => console.log('ğŸ“Š æŠ¥å‘Šç”Ÿæˆå®Œæˆ'), 1000);

        console.log('è°ƒåº¦å™¨çŠ¶æ€:', scheduler.getStatus());

        // 7. å®é™…åº”ç”¨ç¤ºä¾‹ï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰
        console.log('\n7. å®é™…åº”ç”¨ç¤ºä¾‹ï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰');

        /**
         * ä½¿ç”¨é˜Ÿåˆ—å®ç°äºŒå‰æ ‘çš„å±‚åºéå†ï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰
         */
        class TreeNode {
            constructor(val) {
                this.val = val;
                this.left = null;
                this.right = null;
            }
        }

        /**
         * å±‚åºéå†äºŒå‰æ ‘
         *
         * æ ¸å¿ƒæ€æƒ³ï¼š
         * ä½¿ç”¨é˜Ÿåˆ—å­˜å‚¨å¾…è®¿é—®çš„èŠ‚ç‚¹ï¼Œå…ˆè®¿é—®çš„èŠ‚ç‚¹çš„å­èŠ‚ç‚¹å…ˆå…¥é˜Ÿ
         *
         * @param {TreeNode} root - äºŒå‰æ ‘æ ¹èŠ‚ç‚¹
         * @returns {Array} å±‚åºéå†ç»“æœ
         */
        function levelOrderTraversal(root) {
            if (!root) return [];

            const result = [];
            const queue = new Queue();
            queue.enqueue(root);

            console.log('å¼€å§‹å±‚åºéå†äºŒå‰æ ‘');

            while (!queue.isEmpty()) {
                const node = queue.dequeue();
                result.push(node.val);
                console.log(`è®¿é—®èŠ‚ç‚¹: ${node.val}`);

                // å°†å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—
                if (node.left) {
                    queue.enqueue(node.left);
                    console.log(`  å·¦å­èŠ‚ç‚¹ ${node.left.val} å…¥é˜Ÿ`);
                }
                if (node.right) {
                    queue.enqueue(node.right);
                    console.log(`  å³å­èŠ‚ç‚¹ ${node.right.val} å…¥é˜Ÿ`);
                }
            }

            return result;
        }

        // æ„å»ºæµ‹è¯•äºŒå‰æ ‘
        //       1
        //      / \
        //     2   3
        //    / \   \
        //   4   5   6
        const root = new TreeNode(1);
        root.left = new TreeNode(2);
        root.right = new TreeNode(3);
        root.left.left = new TreeNode(4);
        root.left.right = new TreeNode(5);
        root.right.right = new TreeNode(6);

        const traversalResult = levelOrderTraversal(root);
        console.log('å±‚åºéå†ç»“æœ:', traversalResult);

        // 8. æ€§èƒ½æµ‹è¯•
        console.log('\n8. æ€§èƒ½æµ‹è¯•');
        const performanceQueue = new Queue();
        const startTime = performance.now();

        // å¤§é‡å…¥é˜Ÿæ“ä½œ
        for (let i = 0; i < 10000; i++) {
            performanceQueue.enqueue(i);
        }

        // å¤§é‡å‡ºé˜Ÿæ“ä½œ
        for (let i = 0; i < 10000; i++) {
            performanceQueue.dequeue();
        }

        const endTime = performance.now();
        console.log(`10000æ¬¡å…¥é˜Ÿ+å‡ºé˜Ÿæ“ä½œè€—æ—¶: ${(endTime - startTime).toFixed(2)}ms`);
        console.log(`å¹³å‡æ¯æ¬¡æ“ä½œè€—æ—¶: ${((endTime - startTime) / 20000).toFixed(4)}ms`);

        console.log('\n=== é˜Ÿåˆ—ç»“æ„æ¼”ç¤ºå®Œæ¯• ===');
    </script>
</body>

</html>